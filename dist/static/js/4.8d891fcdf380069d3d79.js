webpackJsonp([4],{"0PPM":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),s=a.n(r),n=a("Xxa5"),i=a.n(n),o=a("exGp"),l=a.n(o),c=a("Dd8w"),d=a.n(c),u=a("S2w5"),p=a("NYxO"),m={name:"new",data:function(){return{modalLoading:!0,showModal:!1,storeId:"",track:"",carrier:"",eta:"",columns:[{type:"selection",width:60,align:"center"},{title:"箱子ID",key:"id"}],lists:[],box_id_list:[]}},computed:d()({},Object(p.c)(["globalStoreIdGr"])),watch:{globalStoreIdGr:function(){this._getStoreId()}},methods:d()({},Object(p.b)(["getStoreId","fetchAfterLoginData"]),{getOutboundId:function(){var e=this;return l()(i.a.mark(function t(){var a,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.searchOutboundList({waybill_is_null:1,store_id:e.storeId});case 2:a=t.sent,e.$responseMessage(a.data,200,"",!0)||(r=[],a.data.msg.forEach(function(e){r.push({id:e})}),e.lists=r);case 4:case"end":return t.stop()}},t,e)}))()},_getStoreId:function(){var e=this;return l()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStoreId();case 2:if(e.storeId=t.sent,!e.storeId){t.next=7;break}e.getOutboundId(),t.next=15;break;case 7:return t.next=9,e.fetchAfterLoginData();case 9:if(!(a=t.sent)||!a.data.msg.store_list){t.next=15;break}return t.next=13,e.getStoreId();case 13:e.storeId=t.sent,e.storeId?e.getOutboundId():e.$Message.warning("请选择店铺！");case 15:case"end":return t.stop()}},t,e)}))()},selectItem:function(e){var t=[];e.forEach(function(e){t.push(e.id)}),this.box_id_list=t},openModel:function(){this.showModal=!0},modalLoadingAtion:function(){var e=this;this.showModal=!0,this.modalLoading=!1,window.setTimeout(function(){e.modalLoading=!0},100)},ok:function(){var e=this;window.setTimeout(l()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.$requiredInVerify(e.track,"运单号")||e.$requiredInVerify(e.carrier,"承运人")||e.$requiredInVerify(e.eta,"预计抵达时间"))){t.next=3;break}return e.modalLoadingAtion(),t.abrupt("return");case 3:if(/^\d{4}-\d{2}-\d{2}/.test(e.eta)){t.next=7;break}return e.$Message.warning("预计抵达时间格式错误"),e.modalLoadingAtion(),t.abrupt("return");case 7:return t.next=9,u.a.createNewWaybill({track:e.track,carrier:e.carrier,eta:e.eta,box_id_list:s()(e.box_id_list)});case 9:a=t.sent,e.reset(),e.$responseMessage(a.data,201,"新建成功")||(e.showModal=!1);case 12:case"end":return t.stop()}},t,e)})))},cancel:function(){this.reset()},reset:function(){this.track="",this.carrier="",this.eta=""}}),created:function(){this._getStoreId()}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"manage-box"},[a("div",{staticClass:"wn-add"},[a("Button",{staticClass:"new-opa",attrs:{disabled:!e.box_id_list.length,type:"primary"},nativeOn:{click:function(t){return e.openModel(t)}}},[e._v("新增")])],1),e._v(" "),a("div",{staticClass:"cm-table",staticStyle:{width:"25%"}},[a("Table",{attrs:{border:"",stripe:"",columns:e.columns,data:e.lists},on:{"on-selection-change":e.selectItem}})],1),e._v(" "),a("Modal",{attrs:{title:"新增运单",loading:e.modalLoading},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("div",{staticClass:"modal-item supplier-mi"},[a("span",{staticClass:"vm"},[e._v("运单号：")]),e._v(" "),a("Input",{staticClass:"vm",staticStyle:{width:"200px"},attrs:{placeholder:"请输入",maxlength:60,clearable:""},model:{value:e.track,callback:function(t){e.track=t},expression:"track"}})],1),e._v(" "),a("div",{staticClass:"modal-item supplier-mi"},[a("span",{staticClass:"vm"},[e._v("承运人：")]),e._v(" "),a("Input",{staticClass:"vm",staticStyle:{width:"200px"},attrs:{placeholder:"请输入",maxlength:60,clearable:""},model:{value:e.carrier,callback:function(t){e.carrier=t},expression:"carrier"}})],1),e._v(" "),a("div",{staticClass:"modal-item supplier-mi"},[a("span",{staticClass:"vm"},[e._v("预计抵达时间：")]),e._v(" "),a("Input",{staticClass:"vm",staticStyle:{width:"200px"},attrs:{placeholder:"请输入(格式为YYYY-MM-DD)",maxlength:60,clearable:""},model:{value:e.eta,callback:function(t){e.eta=t},expression:"eta"}})],1)])],1)])},staticRenderFns:[]};var h={name:"manage",data:function(){var e=this;return{searchContent:"",modalLoading:!0,showModal:!1,rowModule:{track:"",carrier:"",eta:"",arrive_date:"",id:""},columns:[{title:"运单号",key:"track",width:120},{title:"承运人",key:"carrier",width:120},{title:"预计抵达时间",key:"eta",width:130},{title:"实际抵达时间",key:"arrive_date",width:130},{title:"操作",key:"action",align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.edit(a.row)}}},"编辑"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.delWaybill(a.row.id)}}},"删除")])}}],lists:[]}},methods:{searchWaybills:function(){var e=this;return l()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.searchWaybills({search:e.searchContent},!0);case 2:a=t.sent,e.$responseMessage(a.data,200,"",!0)||(e.lists=a.data.msg);case 4:case"end":return t.stop()}},t,e)}))()},delWaybill:function(e){var t=this;return l()(i.a.mark(function a(){var r;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u.a.delWaybill(e,!0);case 2:r=a.sent,t.$responseMessage(r.data,204,"删除成功")||t.searchWaybills();case 4:case"end":return a.stop()}},a,t)}))()},edit:function(e){this.rowModule.track=e.track,this.rowModule.carrier=e.carrier,this.rowModule.eta=e.eta,this.rowModule.arrive_date=e.arrive_date,this.rowModule.id=e.id,this.openModel()},openModel:function(){this.showModal=!0},modalLoadingAtion:function(){var e=this;this.showModal=!0,this.modalLoading=!1,window.setTimeout(function(){e.modalLoading=!0},100)},ok:function(){var e=this;window.setTimeout(l()(i.a.mark(function t(){var a,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.$requiredInVerify(e.rowModule.track,"运单号")||e.$requiredInVerify(e.rowModule.carrier,"承运人")||e.$requiredInVerify(e.rowModule.eta,"预计抵达时间")||e.$requiredInVerify(e.rowModule.arrive_date,"实际抵达时间"))){t.next=3;break}return e.modalLoadingAtion(),t.abrupt("return");case 3:if((a=/^\d{4}-\d{2}-\d{2}/).test(e.rowModule.eta)&&a.test(e.rowModule.arrive_date)){t.next=8;break}return e.$Message.warning("预计抵达时间格式错误"),e.modalLoadingAtion(),t.abrupt("return");case 8:return t.next=10,u.a.editWaybill(e.rowModule.id,{track:e.rowModule.track,carrier:e.rowModule.carrier,eta:e.rowModule.eta,arrive_date:e.rowModule.arrive_date});case 10:r=t.sent,e.$responseMessage(r.data,202,"编辑成功")||(e.showModal=!1,e.searchWaybills());case 12:case"end":return t.stop()}},t,e)})))},cancel:function(){}},created:function(){this.searchWaybills()}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"manage-box"},[a("div",{staticClass:"wn-search"},[a("Input",{staticClass:"vm",staticStyle:{width:"210px"},attrs:{placeholder:"输入运单号或承运人(至少四个字符)",clearable:""},model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:"searchContent"}}),e._v(" "),a("Button",{staticClass:"new-opa",attrs:{disabled:e.searchContent.length<4,type:"primary"},nativeOn:{click:function(t){return e.searchWaybills(t)}}},[e._v("搜索")])],1),e._v(" "),a("div",{staticClass:"cm-table",staticStyle:{width:"60%"}},[a("Table",{attrs:{border:"",stripe:"",columns:e.columns,data:e.lists}})],1),e._v(" "),a("Modal",{attrs:{title:"编辑运单",loading:e.modalLoading},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("div",{staticClass:"modal-item supplier-mi"},[a("span",{staticClass:"vm"},[e._v("运单号：")]),e._v(" "),a("Input",{staticClass:"vm",staticStyle:{width:"200px"},attrs:{placeholder:"请输入",maxlength:60,clearable:""},model:{value:e.rowModule.track,callback:function(t){e.$set(e.rowModule,"track",t)},expression:"rowModule.track"}})],1),e._v(" "),a("div",{staticClass:"modal-item supplier-mi"},[a("span",{staticClass:"vm"},[e._v("承运人：")]),e._v(" "),a("Input",{staticClass:"vm",staticStyle:{width:"200px"},attrs:{placeholder:"请输入",maxlength:60,clearable:""},model:{value:e.rowModule.carrier,callback:function(t){e.$set(e.rowModule,"carrier",t)},expression:"rowModule.carrier"}})],1),e._v(" "),a("div",{staticClass:"modal-item supplier-mi"},[a("span",{staticClass:"vm"},[e._v("预计抵达时间：")]),e._v(" "),a("Input",{staticClass:"vm",staticStyle:{width:"200px"},attrs:{placeholder:"请输入",maxlength:60,clearable:""},model:{value:e.rowModule.eta,callback:function(t){e.$set(e.rowModule,"eta",t)},expression:"rowModule.eta"}})],1),e._v(" "),a("div",{staticClass:"modal-item supplier-mi"},[a("span",{staticClass:"vm"},[e._v("实际抵达时间：")]),e._v(" "),a("Input",{staticClass:"vm",staticStyle:{width:"200px"},attrs:{placeholder:"请输入",maxlength:60,clearable:""},model:{value:e.rowModule.arrive_date,callback:function(t){e.$set(e.rowModule,"arrive_date",t)},expression:"rowModule.arrive_date"}})],1)])],1)])},staticRenderFns:[]};var f={name:"waybill",components:{newc:a("VU/8")(m,v,!1,function(e){a("8Ggl")},null,null).exports,manage:a("VU/8")(h,w,!1,function(e){a("74ib")},null,null).exports}},b={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("Tabs",{attrs:{animated:!1}},[t("TabPane",{attrs:{label:"新建运单"}},[t("newc")],1),this._v(" "),t("TabPane",{attrs:{label:"管理运单"}},[t("manage")],1)],1)],1)},staticRenderFns:[]};var g=a("VU/8")(f,b,!1,function(e){a("NBPI")},null,null);t.default=g.exports},"74ib":function(e,t){},"8Ggl":function(e,t){},NBPI:function(e,t){}});
//# sourceMappingURL=4.8d891fcdf380069d3d79.js.map