webpackJsonp([5],{"9n41":function(t,e,n){"use strict";var s=n("Xxa5"),a=n.n(s),o=n("exGp"),r=n.n(o),i=n("S2w5"),l=n("Q0NQ"),c={name:"",data:function(){var t=this;return this.rootColumns=[{title:"用户名",key:"username",width:130},{title:"公司名",key:"company__name",width:130},{title:"姓名",key:"first_name",width:130}],this.adminColumns=[{title:"用户名",key:"username",width:130},{title:"角色",key:"roll",width:130}],{modalLoading:!0,showModal:!1,searchContent:"",count:"",columns:[{title:"操作",key:"action",align:"center",render:function(e,n){return e("div",[e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.deleteUser(n.row.reg_token)}}},"删除")])}}],lists:[],selectRoll:"",rollList:l.a.rollList}},props:["role"],methods:{searchUser:function(){var t=this;return r()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.searchUser({username:t.searchContent});case 2:n=e.sent,t.$responseMessage(n.data,200,"",!0)||(t.lists=n.data.msg);case 4:case"end":return e.stop()}},e,t)}))()},deleteUser:function(t){var e=this;return r()(a.a.mark(function n(){var s;return a.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.deleteUser(t,!0);case 2:s=n.sent,e.$responseMessage(s.data,201,"删除成功"),e.searchUser();case 5:case"end":return n.stop()}},n,e)}))()},openModel:function(){this.showModal=!0},modalLoadingAtion:function(){var t=this;this.showModal=!0,this.modalLoading=!1,window.setTimeout(function(){t.modalLoading=!0},100)},ok:function(){var t=this;window.setTimeout(r()(a.a.mark(function e(){var n;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$requiredInVerify(t.selectRoll,"角色")){e.next=3;break}return t.modalLoadingAtion(),e.abrupt("return");case 3:if(/^\d+$/.test(t.count)){e.next=7;break}return t.$Message.warning("请输入正确格式的数字"),t.modalLoadingAtion(),e.abrupt("return",!1);case 7:return e.next=9,i.a.createNewManager({roll:t.selectRoll,count:t.count});case 9:n=e.sent,t.selectRoll="",t.count="",t.$responseMessage(n.data,201,"",!0)||(t.showModal=!1,t.successTip(n.data.msg));case 13:case"end":return e.stop()}},e,t)})))},cancel:function(){this.selectRoll="",this.count=""},successTip:function(t){var e="";t.forEach(function(t){e+='<p class="link"><a target="_blank"   href="'+window.location.origin+"/#"+t+'">'+window.location.origin+"/#"+t+"</a></p>"}),this.$Modal.success({title:"创建成功",content:"<p>已生成注册链接，链接为：</p>"+e+"<p>请将注册链接发送给需要的人</p>"})},tableInit:function(){"root"===this.role?this.columns=this.rootColumns.concat(this.columns):"admin"===this.role&&(this.columns=this.adminColumns.concat(this.columns))}},created:function(){this.tableInit(),this.searchUser()}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"manage-box"},[n("div",{staticClass:"cm-form"},[n("Input",{staticStyle:{width:"120px"},attrs:{placeholder:"请输入用户名",clearable:""},model:{value:t.searchContent,callback:function(e){t.searchContent=e},expression:"searchContent"}}),t._v(" "),n("Button",{staticClass:"search",attrs:{type:"primary",size:"small"},nativeOn:{click:function(e){return t.searchUser(e)}}},[t._v("搜索")]),t._v(" "),"admin"===t.role?n("Button",{staticClass:"new-opa",attrs:{type:"primary",size:"small"},nativeOn:{click:function(e){return t.openModel(e)}}},[t._v("新增")]):t._e()],1),t._v(" "),n("div",{staticClass:"cm-table users-table",style:{width:"root"===t.role?"45%":"35%"}},[n("Table",{attrs:{border:"",stripe:"",columns:t.columns,data:t.lists}})],1),t._v(" "),n("Modal",{attrs:{title:"新增用户",loading:t.modalLoading},on:{"on-ok":t.ok,"on-cancel":t.cancel},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[n("div",{staticClass:"roll-select"},[n("Select",{staticStyle:{width:"100px"},model:{value:t.selectRoll,callback:function(e){t.selectRoll=e},expression:"selectRoll"}},t._l(t.rollList,function(e){return n("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1),t._v(" "),n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入新增用户数量",clearable:""},model:{value:t.count,callback:function(e){t.count=e},expression:"count"}})],1)],1)])},staticRenderFns:[]};var d=n("VU/8")(c,u,!1,function(t){n("h+/C")},null,null);e.a=d.exports},XTOG:function(t,e){},"h+/C":function(t,e){},s0NV:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={name:"manageUsers",data:function(){return{}},components:{users:n("9n41").a}},a={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("users",{attrs:{role:"admin"}})],1)},staticRenderFns:[]};var o=n("VU/8")(s,a,!1,function(t){n("XTOG")},null,null);e.default=o.exports}});
//# sourceMappingURL=5.a03cab2e2091864b7004.js.map