webpackJsonp([1],{"9n41":function(e,t,n){"use strict";var a=n("Xxa5"),s=n.n(a),o=n("exGp"),r=n.n(o),i=n("S2w5"),c=n("Q0NQ"),l={name:"",data:function(){var e=this;return this.rootColumns=[{title:"用户名",key:"username",width:130},{title:"公司名",key:"company__name",width:130},{title:"姓名",key:"first_name",width:130}],this.adminColumns=[{title:"用户名",key:"username",width:130},{title:"角色",key:"roll",width:130}],{modalLoading:!0,showModal:!1,searchContent:"",count:"",columns:[{title:"操作",key:"action",align:"center",render:function(t,n){return t("div",[t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.deleteUser(n.row.reg_token)}}},"删除")])}}],lists:[],selectRoll:"",rollList:c.a.rollList}},props:["role"],methods:{searchUser:function(){var e=this;return r()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.searchUser({username:e.searchContent});case 2:n=t.sent,e.$responseMessage(n.data,200,"",!0)||(e.lists=n.data.msg);case 4:case"end":return t.stop()}},t,e)}))()},deleteUser:function(e){var t=this;return r()(s.a.mark(function n(){var a;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.deleteUser(e,!0);case 2:a=n.sent,t.$responseMessage(a.data,201,"删除成功"),t.searchUser();case 5:case"end":return n.stop()}},n,t)}))()},openModel:function(){this.showModal=!0},modalLoadingAtion:function(){var e=this;this.showModal=!0,this.modalLoading=!1,window.setTimeout(function(){e.modalLoading=!0},100)},ok:function(){var e=this;window.setTimeout(r()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$requiredInVerify(e.selectRoll,"角色")){t.next=3;break}return e.modalLoadingAtion(),t.abrupt("return");case 3:if(/^\d+$/.test(e.count)){t.next=7;break}return e.$Message.warning("请输入正确格式的数字"),e.modalLoadingAtion(),t.abrupt("return",!1);case 7:return t.next=9,i.a.createNewManager({roll:e.selectRoll,count:e.count});case 9:n=t.sent,e.selectRoll="",e.count="",e.$responseMessage(n.data,201,"",!0)||(e.showModal=!1,e.successTip(n.data.msg));case 13:case"end":return t.stop()}},t,e)})))},cancel:function(){this.selectRoll="",this.count=""},successTip:function(e){var t="";e.forEach(function(e){t+='<p class="link"><a target="_blank"   href="'+window.location.origin+"/#"+e+'">'+window.location.origin+"/#"+e+"</a></p>"}),this.$Modal.success({title:"创建成功",content:"<p>已生成注册链接，链接为：</p>"+t+"<p>请将注册链接发送给需要的人</p>"})},tableInit:function(){"root"===this.role?this.columns=this.rootColumns.concat(this.columns):"admin"===this.role&&(this.columns=this.adminColumns.concat(this.columns))}},created:function(){this.tableInit(),this.searchUser()}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"manage-box"},[n("div",{staticClass:"cm-form"},[n("Input",{staticStyle:{width:"120px"},attrs:{placeholder:"请输入用户名",clearable:""},model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:"searchContent"}}),e._v(" "),n("Button",{staticClass:"search",attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return e.searchUser(t)}}},[e._v("搜索")]),e._v(" "),"admin"===e.role?n("Button",{staticClass:"new-opa",attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return e.openModel(t)}}},[e._v("新增")]):e._e()],1),e._v(" "),n("div",{staticClass:"cm-table users-table",style:{width:"root"===e.role?"45%":"35%"}},[n("Table",{attrs:{border:"",stripe:"",columns:e.columns,data:e.lists}})],1),e._v(" "),n("Modal",{attrs:{title:"新增用户",loading:e.modalLoading},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[n("div",{staticClass:"roll-select"},[n("Select",{staticStyle:{width:"100px"},model:{value:e.selectRoll,callback:function(t){e.selectRoll=t},expression:"selectRoll"}},e._l(e.rollList,function(t){return n("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1),e._v(" "),n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入新增用户数量",clearable:""},model:{value:e.count,callback:function(t){e.count=t},expression:"count"}})],1)],1)])},staticRenderFns:[]};var d=n("VU/8")(l,u,!1,function(e){n("h+/C")},null,null);t.a=d.exports},JBKk:function(e,t){},JQs2:function(e,t){},WBLy:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("Xxa5"),s=n.n(a),o=n("exGp"),r=n.n(o),i=n("S2w5"),c={name:"",data:function(){var e=this;return{modalLoading:!0,searchContent:"",showModal:!1,companyName:"",columns:[{title:"公司名",key:"name",width:130},{title:"操作",key:"action",align:"center",render:function(t,n){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"15px"},on:{click:function(){e.createNewManager(n.row.id)}}},"新建管理员"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.deleteCompany(n.row.id)}}},"删除")])}}],lists:[]}},methods:{createNewManager:function(e){var t=this;return r()(s.a.mark(function n(){var a;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.createNewManager({company_id:e},!0);case 2:a=n.sent,t.$responseMessage(a.data,200,"",!0)||t.successTip(a.data.msg);case 4:case"end":return n.stop()}},n,t)}))()},searchCompany:function(){var e=this;return r()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.searchCompany({search:e.companyName},!0);case 2:n=t.sent,e.$responseMessage(n.data,200,"",!0)||(e.lists=n.data.msg);case 4:case"end":return t.stop()}},t,e)}))()},deleteCompany:function(e){var t=this;return r()(s.a.mark(function n(){var a;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.deleteCompany(e,!0);case 2:a=n.sent,t.$responseMessage(a.data,200);case 4:case"end":return n.stop()}},n,t)}))()},openModel:function(){this.showModal=!0},modalLoadingAtion:function(){var e=this;this.showModal=!0,this.modalLoading=!1,window.setTimeout(function(){e.modalLoading=!0},100)},ok:function(){var e=this;window.setTimeout(r()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$requiredInVerify(e.companyName,"公司名")){t.next=3;break}return e.modalLoadingAtion(),t.abrupt("return");case 3:return t.next=5,i.a.createNewCompany({company_name:e.companyName});case 5:n=t.sent,e.companyName="",e.$responseMessage(n.data,201,"",!0)?e.modalLoadingAtion():(e.showModal=!1,e.successTip(n.data.msg));case 8:case"end":return t.stop()}},t,e)})))},cancel:function(){this.companyName=""},successTip:function(e){this.$Modal.success({title:"创建成功",content:'<p>已生成注册链接，链接为：<a target="_blank"   href="'+window.location.origin+"/#"+e+'">'+window.location.origin+"/#"+e+"</a></p><p>请将注册链接发送给需要的人</p>"})}},created:function(){this.searchCompany()}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"manage-box"},[n("div",{staticClass:"cm-form"},[n("Input",{staticStyle:{width:"120px"},attrs:{placeholder:"请输入公司名",clearable:""},model:{value:e.searchContent,callback:function(t){e.searchContent=t},expression:"searchContent"}}),e._v(" "),n("Button",{staticClass:"search",attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return e.searchCompany(t)}}},[e._v("搜索")]),e._v(" "),n("Button",{staticClass:"new-opa",attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return e.openModel(t)}}},[e._v("新建公司")])],1),e._v(" "),n("div",{staticClass:"cm-table"},[n("Table",{attrs:{border:"",stripe:"",columns:e.columns,data:e.lists}})],1),e._v(" "),n("div",{},[n("Modal",{attrs:{title:"新建公司",loading:e.modalLoading},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入公司名，不超过60个字符",maxlength:60,clearable:""},model:{value:e.companyName,callback:function(t){e.companyName=t},expression:"companyName"}})],1)],1)])},staticRenderFns:[]};var u=n("VU/8")(c,l,!1,function(e){n("JQs2")},null,null).exports,d={name:"manageUsers",data:function(){return{}},components:{users:n("9n41").a}},m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("users",{attrs:{role:"root"}})],1)},staticRenderFns:[]};var p={name:"rootManage",components:{companyManage:u,manageUsers:n("VU/8")(d,m,!1,function(e){n("JBKk")},null,null).exports}},h={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("Tabs",{attrs:{animated:!1}},[t("TabPane",{attrs:{label:"公司管理"}},[t("company-manage")],1),this._v(" "),t("TabPane",{attrs:{label:"管理员用户管理"}},[t("manage-users")],1)],1)],1)},staticRenderFns:[]};var f=n("VU/8")(p,h,!1,function(e){n("wtVO")},null,null);t.default=f.exports},"h+/C":function(e,t){},wtVO:function(e,t){}});
//# sourceMappingURL=1.72af7bf0563bea812c21.js.map